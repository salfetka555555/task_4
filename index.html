<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Bank Card Form</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 20px;
        }
        .container {
            display: flex;
            gap: 40px;
            margin-bottom: 40px;
        }
        form { 
            flex: 1;
            max-width: 500px; 
        }
        .card-preview {
            flex: 1;
            max-width: 400px;
        }
        .mini-card {
            width: 320px;
            height: 200px;
            background: linear-gradient(135deg, #2c3e50, #4a6491);
            border-radius: 15px;
            padding: 20px;
            color: white;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
            font-family: 'Courier New', monospace;
        }
        .chip {
            width: 50px;
            height: 40px;
            background: linear-gradient(45deg, #ffd700, #ffa500);
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .card-number {
            font-size: 22px;
            letter-spacing: 2px;
            margin-bottom: 20px;
            font-family: monospace;
        }
        .card-details {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-top: 30px;
        }
        .card-holder {
            font-size: 16px;
            text-transform: uppercase;
        }
        .card-expiry {
            font-size: 16px;
        }
        .card-logo {
            position: absolute;
            top: 20px;
            right: 20px;
            height: 40px;
        }
        .bank-logo {
            position: absolute;
            bottom: 20px;
            right: 20px;
            height: 30px;
        }
        label { 
            display: block; 
            margin-bottom: 10px; 
            font-weight: bold;
        }
        input[type=text], select { 
            width: 100%; 
            padding: 10px; 
            margin-bottom: 15px; 
            border: 1px solid #ccc; 
            border-radius: 4px; 
            box-sizing: border-box;
        }
        .expiry-container { 
            display: flex; 
            gap: 10px; 
        }
        .expiry-container select { 
            flex: 1; 
        }
        button { 
            background-color: #4CAF50; 
            color: white; 
            padding: 12px 20px; 
            border: none; 
            border-radius: 4px; 
            cursor: pointer; 
            width: 100%; 
            font-size: 16px;
            font-weight: bold;
            margin-top: 10px;
        }
        button:hover {
            background-color: #45a049;
        }
        .error { 
            color: red; 
            font-size: 14px; 
            margin-top: -10px; 
            margin-bottom: 10px; 
            min-height: 20px;
        }
        h2 {
            text-align: center;
            margin-bottom: 30px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        th {
            background-color: #4CAF50;
            color: white;
            padding: 12px;
            text-align: left;
        }
        td {
            padding: 12px;
            border-bottom: 1px solid #ddd;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .empty-table {
            text-align: center;
            color: #999;
            font-style: italic;
            padding: 20px;
        }
        .card-system-icon {
            height: 24px;
            vertical-align: middle;
            margin-right: 5px;
        }
        .bank-icon {
            height: 20px;
            vertical-align: middle;
            margin-right: 5px;
        }
    </style>
</head>
<body>
<h2>Форма банковских данных</h2>

<div class="container">
    <form id="cardForm">
        <label for="bank">Банк:</label>
        <select id="bank" name="bank">
            <option value="">Выберите банк...</option>
            <option value="sber">Сбербанк</option>
            <option value="tinkoff">Тинькофф</option>
            <option value="alfa">Альфа-Банк</option>
            <option value="vtb">ВТБ</option>
            <option value="gazprom">Газпромбанк</option>
            <option value="other">Другой</option>
        </select>
        
        <label for="card-system">Платёжная система:</label>
        <select id="card-system" name="card_system">
            <option value="">Выберите систему...</option>
            <option value="visa">Visa</option>
            <option value="mastercard">MasterCard</option>
            <option value="mir">МИР</option>
            <option value="unionpay">UnionPay</option>
        </select>

        <label for="card-number">Номер карты:</label>
        <input type="text" id="card-number" name="card_number" placeholder="XXXX XXXX XXXX XXXX" maxlength="19" />
        <div class="error" id="cardError"></div>

        <label for="expiry-date">Срок действия:</label>
        <div class="expiry-container">
            <select id="month" name="month">
                <option value="">Месяц...</option>
            </select>
            <select id="year" name="year">
                <option value="">Год...</option>
            </select>
        </div>
        <div class="error" id="expiryError"></div>

        <label for="cvv-code">CVV-код:</label>
        <input type="text" id="cvv-code" name="cvv_code" placeholder="XXX" maxlength="3" />
        <div class="error" id="cvvError"></div>

        <label for="holder-name">Имя владельца:</label>
        <input type="text" id="holder-name" name="holder_name" placeholder="ВАШЕ ИМЯ" />
        <div class="error" id="holderError"></div>

        <button type="submit">Добавить карту</button>
    </form>

    <div class="card-preview">
        <h3>Предпросмотр карты:</h3>
        <div class="mini-card">
            <div class="chip"></div>
            <div class="card-number" id="preview-number">**** **** **** ****</div>
            <div class="card-details">
                <div class="card-holder" id="preview-holder">ВАШЕ ИМЯ</div>
                <div class="card-expiry" id="preview-expiry">ММ/ГГ</div>
            </div>
            <img id="preview-system" class="card-logo" src="" alt="" style="display: none;">
            <img id="preview-bank" class="bank-logo" src="" alt="" style="display: none;">
        </div>
    </div>
</div>

<h3>Добавленные карты:</h3>
<table id="cardsTable">
    <thead>
        <tr>
            <th>Банк</th>
            <th>Платёжная система</th>
            <th>Номер карты</th>
            <th>Срок действия</th>
            <th>Владелец</th>
            <th>Дата добавления</th>
        </tr>
    </thead>
    <tbody id="cardsTableBody">
        <tr id="emptyRow">
            <td colspan="6" class="empty-table">Нет добавленных карт</td>
        </tr>
    </tbody>
</table>

<script>
    const systemLogos = {
        visa: 'https://upload.wikimedia.org/wikipedia/commons/5/5e/Visa_Inc._logo.svg',
        mastercard: 'https://upload.wikimedia.org/wikipedia/commons/2/2a/Mastercard-logo.svg',
        mir: 'https://upload.wikimedia.org/wikipedia/commons/9/9a/Mir_logo.svg',
        unionpay: 'https://upload.wikimedia.org/wikipedia/commons/1/1b/UnionPay_logo.svg'
    };

    const bankLogos = {
        sber: 'https://upload.wikimedia.org/wikipedia/commons/thumb/9/9b/Sberbank_Logo_2020.svg/500px-Sberbank_Logo_2020.svg.png',
        tinkoff: 'https://upload.wikimedia.org/wikipedia/commons/thumb/1/17/T-Bank_RU_logo.svg/250px-T-Bank_RU_logo.svg.png',
        alfa: 'https://upload.wikimedia.org/wikipedia/commons/thumb/7/77/Alfa-Bank.svg/330px-Alfa-Bank.svg.png',
        vtb: 'https://upload.wikimedia.org/wikipedia/commons/6/69/VTB_Logo_2015.svg',
        gazprom: 'https://upload.wikimedia.org/wikipedia/commons/8/88/Gazprombank_Logo.svg',
        other: ''
    };

    document.addEventListener('DOMContentLoaded', function() {
        const monthSelect = document.getElementById('month');
        const yearSelect = document.getElementById('year');
        const currentYear = new Date().getFullYear();

        for (let i = 1; i <= 12; i++) {
            const option = document.createElement('option');
            option.value = i.toString().padStart(2, '0');
            option.textContent = i.toString().padStart(2, '0');
            monthSelect.appendChild(option);
        }

        for (let i = 0; i <= 10; i++) {
            const option = document.createElement('option');
            option.value = (currentYear + i).toString().slice(-2);
            option.textContent = (currentYear + i).toString();
            yearSelect.appendChild(option);
        }

        document.querySelectorAll('#cardForm input, #cardForm select').forEach(element => {
            element.addEventListener('input', updateCardPreview);
            element.addEventListener('change', updateCardPreview);
        });
    });

    document.getElementById('card-number').addEventListener('input', function(e) {
        let value = e.target.value.replace(/\D/g, '');
        value = value.replace(/(.{4})/g, '$1 ').trim();
        e.target.value = value.substring(0, 19);
        updateCardPreview();
    });

    document.getElementById('cvv-code').addEventListener('input', function(e) {
        e.target.value = e.target.value.replace(/\D/g, '').substring(0, 3);
        updateCardPreview();
    });

    document.getElementById('holder-name').addEventListener('input', function(e) {
        e.target.value = e.target.value.replace(/[^a-zA-Zа-яА-ЯёЁ\s]/g, '').toUpperCase();
        updateCardPreview();
    });

    function updateCardPreview() {
        const cardNumber = document.getElementById('card-number').value;
        document.getElementById('preview-number').textContent = 
            cardNumber || '**** **** **** ****';

        const holderName = document.getElementById('holder-name').value;
        document.getElementById('preview-holder').textContent = 
            holderName || 'ВАШЕ ИМЯ';

        const month = document.getElementById('month').value;
        const year = document.getElementById('year').value;
        document.getElementById('preview-expiry').textContent = 
            (month && year) ? `${month}/${year}` : 'ММ/ГГ';

        const system = document.getElementById('card-system').value;
        const systemImg = document.getElementById('preview-system');
        if (system && systemLogos[system]) {
            systemImg.src = systemLogos[system];
            systemImg.style.display = 'block';
        } else {
            systemImg.style.display = 'none';
        }

        const bank = document.getElementById('bank').value;
        const bankImg = document.getElementById('preview-bank');
        if (bank && bankLogos[bank]) {
            bankImg.src = bankLogos[bank];
            bankImg.style.display = 'block';
        } else {
            bankImg.style.display = 'none';
        }
    }

    document.getElementById('cardForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const errors = {};
        
        const bank = document.getElementById('bank').value;
        if (!bank) {
            errors.bank = 'Выберите банк';
        }
        
        const cardSystem = document.getElementById('card-system').value;
        if (!cardSystem) {
            errors.system = 'Выберите платёжную систему';
        }
        
        const cardNumber = document.getElementById('card-number').value.replace(/\s/g, '');
        if (!/^\d{16}$/.test(cardNumber)) {
            errors.card = 'Номер карты должен содержать 16 цифр';
        }
        
        const month = document.getElementById('month').value;
        const year = document.getElementById('year').value;
        if (!month || !year) {
            errors.expiry = 'Выберите месяц и год';
        } else {
            const currentYear = new Date().getFullYear() % 100;
            const currentMonth = new Date().getMonth() + 1;
            if (parseInt(year) < currentYear || 
                (parseInt(year) === currentYear && parseInt(month) < currentMonth)) {
                errors.expiry = 'Карта просрочена';
            }
        }
        
        const cvv = document.getElementById('cvv-code').value;
        if (!/^\d{3}$/.test(cvv)) {
            errors.cvv = 'CVV должен содержать 3 цифры';
        }
        
        const holderName = document.getElementById('holder-name').value.trim();
        if (!holderName || holderName.length < 3) {
            errors.holder = 'Введите полное имя';
        }
        
        document.querySelectorAll('.error').forEach(el => el.textContent = '');
        
        if (errors.bank) document.getElementById('cardError').previousElementSibling.previousElementSibling.textContent = errors.bank;
        if (errors.system) document.getElementById('cardError').previousElementSibling.textContent = errors.system;
        if (errors.card) document.getElementById('cardError').textContent = errors.card;
        if (errors.expiry) document.getElementById('expiryError').textContent = errors.expiry;
        if (errors.cvv) document.getElementById('cvvError').textContent = errors.cvv;
        if (errors.holder) document.getElementById('holderError').textContent = errors.holder;
        
        if (Object.keys(errors).length === 0) {
            addCardToTable({
                bank: bank,
                system: cardSystem,
                number: cardNumber,
                month: month,
                year: year,
                cvv: cvv,
                holder: holderName
            });
            
            clearForm();
        }
    });

    function addCardToTable(cardData) {
        const emptyRow = document.getElementById('emptyRow');
        if (emptyRow) {
            emptyRow.remove();
        }
        
        const tableBody = document.getElementById('cardsTableBody');
        
        const newRow = document.createElement('tr');
        
        const formattedNumber = cardData.number.replace(/(\d{4})/g, '$1 ').trim();
        const maskedNumber = '**** **** **** ' + cardData.number.slice(-4);
        
        const now = new Date();
        const dateString = now.toLocaleDateString('ru-RU') + ' ' + now.toLocaleTimeString('ru-RU', {hour: '2-digit', minute:'2-digit'});
        
        newRow.innerHTML = `
            <td>
                ${bankLogos[cardData.bank] ? `<img src="${bankLogos[cardData.bank]}" alt="${cardData.bank}" class="bank-icon">` : ''}
                ${getBankName(cardData.bank)}
            </td>
            <td>
                ${systemLogos[cardData.system] ? `<img src="${systemLogos[cardData.system]}" alt="${cardData.system}" class="card-system-icon">` : ''}
                ${getSystemName(cardData.system)}
            </td>
            <td>${maskedNumber}</td>
            <td>${cardData.month}/${cardData.year}</td>
            <td>${cardData.holder}</td>
            <td>${dateString}</td>
        `;
        
        // Добавляем строку в таблицу
        tableBody.appendChild(newRow);
    }

    function getBankName(bankCode) {
        const bankNames = {
            sber: 'Сбербанк',
            tinkoff: 'Тинькофф',
            alfa: 'Альфа-Банк',
            vtb: 'ВТБ',
            gazprom: 'Газпромбанк',
            other: 'Другой'
        };
        return bankNames[bankCode] || bankCode;
    }

    function getSystemName(systemCode) {
        const systemNames = {
            visa: 'Visa',
            mastercard: 'MasterCard',
            mir: 'МИР',
            unionpay: 'UnionPay'
        };
        return systemNames[systemCode] || systemCode;
    }

    function clearForm() {
        document.getElementById('cardForm').reset();
        document.querySelectorAll('.error').forEach(el => el.textContent = '');
        
        document.getElementById('preview-number').textContent = '**** **** **** ****';
        document.getElementById('preview-holder').textContent = 'ВАШЕ ИМЯ';
        document.getElementById('preview-expiry').textContent = 'ММ/ГГ';
        document.getElementById('preview-system').style.display = 'none';
        document.getElementById('preview-bank').style.display = 'none';
        
        alert('Карта успешно добавлена в таблицу!');
    }

    updateCardPreview();
</script>
</body>
</html>

